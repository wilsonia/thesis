\usetikzlibrary{shapes.geometric}
\usetikzlibrary{positioning}

\chapter{Consistent Histories}

The probability postulate makes predictions about the results of the standard description of measurement. We can no longer frame the calculation of probabilities within this context, as we have  described measurement as a unitary process and discarded the projection postulate. This motivates the search for a method of assigning probability distributions to sets of unitary outcomes in general.

The \textit{consistent histories} approach extends the probability postulate to make predictions about  more general \textit{quantum histories} rather than measurement results. This is accomplished by modifying both the formalism and interpretation of quantum mechanics; hence, consistent histories is called an ''approach` to quantum mechanics.

First, we rearticulate some of the foundational mathematics and reasoning originally proposed by Robert Griffiths in 1984 TODO CITE. Then, we develop the approach further to make predictions about Stern-Gerlach experiments; this is done using the perspective of Murray Gell-Mann and James Hartle, who independently published the same ideas in 199TODO under the name ``decoherent histories''.

% TODO: find place for this:
% In this thesis, we are careful to distinguish between formalism and interpretation. The formalism of a theory consists of the mathematical objects used to make predictions; for quantum theory, . Because consistent histories modifies both the formalism and interpretation of quantum mechanics, we refer to it as an approach. Formalism: all time evolution is unitary, . Interpretation: when to use Born rule, language of what objects mean (class operators characterize histories).
%
% Separating formalism from interpretation isolates testable differences between competing approaches. We will see that the predictions of standard quantum mechanics are a subset of the predictions made by consistent histories.
%
%
%
% That is, the formalism can stay, but we need different words surrounding it to give it meaning.

% We will see later that without apparatus degree of freedom, we could not make histories TODO. So, the inability of our model to retain information about a state is a direct consequence of the incompleteness of our system, not a fundamental issue of quantum mechanics. TODO: introduce decoherence.

\section{Events and Histories}

% A \textit{quantum property} is a true or false statement about a physical variable. Recalling Experiment 1, we found that the system will posses one of two properties at the end of measurement:
% \begin{itemize}
%   \item ``Spin along the $z$ axis is $\frac{\hbar}{2}$''
%   \item ``Spin along the $z$ axis is $-\frac{\hbar}{2}$''
% \end{itemize}
%
% A property corresponds to a subspace of the Hilbert space. For example, the subspace corresponding to the spin-up property is only $\{\ket{+}\}$, while the subspace corresponding to the property ``spin along the $z$ axis is either up or down'' is $\{\ket{+}, \ket{-}\}$. Notice that this does not include linear combinations of $\ket{+}$ and $\ket{-}$; only pure states are interpreted as having definite properties.

In probability theory, a sample space consists of an exhaustive set of mutually exclusive outcomes, called \textit{events}. In quantum mechanics, the sample space for a physical variable is found by decomposing the identity in that variable's basis. Each term in the decomposition represents a \textit{quantum event}. For example, the sample space of $S_z$ consists of the terms in
\begin{align}
  I = \sum_i P^{S_z}_i = P^{S_z}_+ + P^{S_z}_-
\end{align}

Events exist within the context of a particular sample space. Consequently, we can  use logical reasoning to make conjuctive or negative statements about events. For example, the event for ``spin is either up or down'' is the sum of spin-up and spin-down events, $P^z_+ + P^z_- = I$. Note that asserting that the system is either spin-up or spin-down is the conjunction of all outcomes in the sample space, so it is equivalent to asserting nothing at all.

A \textit{quantum history} is a set of events at sequential times. As finite sets, histories necessarily ignore an infinite amount of insignificant events.

\subsection{Experiment 1}
The histories for measuring spin-up and spin-down are
\begin{align}
  h_\pm &= \left( \left(P_{\psi_{S_z}} \otimes P^\mathcal{X}_\varnothing \otimes P^\epsilon_\varnothing \right), \left(P^{S_z}_\pm \otimes P^\mathcal{X}_\pm \otimes P^\epsilon_\pm \right)  \right)  \\ \nonumber
  h_\pm &= \left(P_\varnothing, P_{\pm_z} \right)
\end{align}
naming the events in the second line to simplify future expressions.

The first event describes the system at time $t_0$ before measurement. It asserts that the spin system is in the initial state $\ket{\psi_s}$, that the position system is in the ready state ${\ket{\varnothing_\mathcal{X}}}$, and that the environment has not yet encoded a result $\ket{\varnothing_\epsilon}$. The second event describes the system at time $t_1$ after measurement. It asserts that the spin system is either up or down, $\ket{\psi_\pm}$, that the position system is in the up or down state ${\ket{\pm\mathcal{X}}}$, and that the environment has encoded a result or up or down $\ket{\varnothing_\pm}$. It is the occurence of spin-up measurement $h_+$ and spin-down measurement $h_-$ for which we make predictions.

\section{Class Operators}

To facilitate the calculation of probabilitys, we seek to write an operator that takes an initial state through the events of a given history.

\subsection{Experiment 2}

To find such an operator, we follow a path from the initial state to some final outcome in TODO REF FIGURE, operating on the initial state with unitary dynamics and event projectors along the way. We call the resulting state the \textit{branch wavefunction} for that history, labeled $\ket{\psi_h}$.

Returning to Experiment 2, we are interested in events at times $t_0$ (before the first measurement), $t_1$ (after the first measurement / before the second measurement), and $t_2$ (after the sceond measurement). The history for measuring spin-up at the $z$ analyzer followed by measuring spin-down at the $x$ analyzer is
\begin{align}
  h_{+_z, -_x} = \left( P_\varnothing, P_{+_z} ,P_{-_x} \right)
\end{align}
%
% We begin by assuming the form
% \begin{align}
%   U(t_2, t_0) C^\dagger_h
% \end{align}
% where $U(t_2, t_0)$ is responsible for time evolution state, and $C^\dagger_h$ is responsible for selecting
First, we assert that the state initially occurs with the first event in the history
\begin{align}
  \ket{\psi_h} = P_\varnothing \: \ket{\psi}
\end{align}
Then, we assert that after evolution from $t_0$ to $t_1$, the event for measuring spin-up occurs
\begin{align}
  \ket{\psi_h} = P^{S_z}_+ \: U(t_1, t_0) \: P_\varnothing \: \ket{\psi}
\end{align}
Finally, we assert that after evolution from $t_1$ to $t_2$, the event for measuring spin-down occurs
\begin{align}
  \ket{\psi_h} = P^{S_x}_- \: U(t_2, t_1) \: P^{S_z}_+ \: U(t_1, t_0) \: P_\varnothing \: \ket{\psi}
\end{align}
Writing all unitary operators with time starting at $t_0$,
\begin{align}
  \ket{\psi_h} &= P^{S_x}_- \: U(t_2, t_0) \: U^\dagger(t_1, t_0) \: P^{S_z}_+ \: U(t_1, t_0) \: P_\varnothing \: \ket{\psi} \\ \nonumber
  &= \left(P^{S_x}_- \: U(t_2, t_0) \right) \left( U^\dagger(t_1, t_0) \: P^{S_z}_+ \: U(t_1, t_0) \right) \left( P_\varnothing \right) \: \ket{\psi} \\ \nonumber
  &= U(t_2, t_0)\left(U^\dagger(t_2, t_0) \: P^{S_x}_- \: U(t_2, t_0) \right) \left( U^\dagger(t_1, t_0) \: P^{S_z}_+ \: U(t_1, t_0) \right) \left( P_\varnothing \right) \: \ket{\psi}
\end{align}
we recognize the Heisenberg picture event operators ${P}(t) = U^\dagger(t, t_0) \: P \: U(t, t_0)$. In terms of Heisenberg projectors,
\begin{align}
  \ket{\psi_h} &= U(t_2, t_0) \: {P^{S_x}_-(t_2)} \: {P^{S_z}_+(t_1)} \: {P_\varnothing(t_0)} \: \ket{\psi} \\ \nonumber
  \ket{\psi_h} &= U(t_2, t_0) C_h^\dagger \ket{\psi}
\end{align}

$C_h$ is called the \textit{class operator} for history $h$.  Conventionally, this operator is written with projectors appearing in the same left-to-right reading order as the order of events in the history. By calling our operator $C_h^\dagger$, we invert this order so that the event projectors operate on the initial state in the correct order.

In general, the class operator for a set of $n$ histories is defined by
\begin{align}
  C_h^\dagger = P_n(t_n) \: P_{n-1}(t_{n-1}) \: ... \: P_0(t_0)
\end{align}
which corresponds to the branch wavefunction
\begin{align}
  \ket{\psi_h} = U(t_n, t_0) C_h^\dagger \ket{\psi}
\end{align}

\section{Extending the Probability Postulate}

The standard probability postulate is written as the inner product of the system state $\ket{\psi}$ and an eigenstate of a physical variable $\ket{a_n}$. It can instead be written in terms of the projection operator for $\ket{a_n}$ by expanding the complex square.
\begin{align}
        \mathcal{P}(n) &= |\braket{a_n|\psi}|^2 \\ \nonumber
        &= \braket{\psi|a_n} \braket{a_n|\psi} \\ \nonumber
        &= \bra{\psi} P^a_n \ket{\psi}
\end{align}

To extend this postulate to make predictions about histories, we replace measurement result projector $P^a_n$ with the history projector $C_h^\dagger$
\begin{align}
  \mathcal{P}(h_n) = \bra{\psi} C_h^\dagger \ket{\psi}
\end{align}

\subsection{Experiment 1}
The class operator for measuring spin-up or spin-down is
\begin{align}
  C_\pm^\dagger = P^{S_z}_\pm (t_1) \: P_\varnothing (t_0)
\end{align}
so the extended Born Rule assigns probability
\begin{align}
  \mathcal{P}(\pm) &= \bra{\psi} C_\pm^\dagger \ket{\psi} \\ \nonumber
  &= \bra{\psi} P^{S_z}_\pm (t_1) \: P_\varnothing (t_0) \ket{\psi}
\end{align}
$P_\varnothing (t_0)$ confirms that $\ket{\psi}$ is the correct initial state:
% \begin{align}
%   P_\varnothing (t_0) \ket{\psi} &=  \left(P_{\psi_s} \otimes P^\mathcal{X}_\varnothing \otimes P^\epsilon_\varnothing \right) \left(\ket{\psi_s} \otimes \ket{\varnothing_\mathcal{X}} \otimes \ket{\varnothing_\epsilon} \right) \\ \nonumber
%   &= \ket{\psi_s} \otimes \ket{\varnothing_\mathcal{X}} \otimes \ket{\varnothing_\epsilon} \right \\ \nonumber
%   &= \ket{\psi}
% \end{align}
so
\begin{align}
  \mathcal{P}(\pm) &= \bra{\psi} P^{S_z}_\pm (t_1) \ket{\psi}
\end{align}
The Heisenberg projector at $t_1$ is
\begin{align}
  P^{S_z}_\pm (t_1) = U^\dagger(t_1, t_0) P^{S_z}_\pm U(t_1, t_0)
\end{align}
so
\begin{align}
  \mathcal{P}(\pm) &= \bra{\psi} U^\dagger(t_1, t_0) P^{S_z}_\pm U(t_1, t_0) \ket{\psi}
\end{align}
Using the dynamics found in TODO REF, we find
\begin{align}
  U(t_1, t_0) \ket{\psi} &= P^{S_z}_+ \ket{\psi_s} \otimes \ket{+_\mathcal{X}} \otimes \ket{+_\epsilon} + P^{S_z}_- \ket{\psi_s} \otimes \ket{-_\mathcal{X}} \otimes \ket{-_\epsilon} \\ \nonumber
  \bra{\psi} U^\dagger(t_1, t_0) &= \bra{\psi_s}P^{S_z}_+ \otimes \bra{+_\mathcal{X}} \otimes \bra{+_\epsilon} + \bra{\psi_s}P^{S_z}_- \otimes \bra{-_\mathcal{X}} \otimes \bra{-_\epsilon}
\end{align}
Applying the event projector,
\begin{align}
  P^{S_z}_\pm U(t_1, t_0) \ket{\psi} &= P^{S_z}_\pm \ket{\psi_s} \otimes \ket{\pm_\mathcal{X}} \otimes \ket{\pm_\epsilon}
\end{align}
so
\begin{align}
  \mathcal{P}(\pm) &= \left(\bra{\psi}  U^\dagger(t_1, t_0)\right) \left( P^{S_z}_\pm \ket{\psi_s} \otimes \ket{\pm_\mathcal{X}} \otimes \ket{\pm_\epsilon}\right) \\ \nonumber
   &= \left(\bra{\psi_s}P^{S_z}_\pm \otimes \bra{\pm_\mathcal{X}} \otimes \bra{\pm_\epsilon} \pm \bra{\psi_s}P^{S_z}_- \otimes \bra{-_\mathcal{X}} \otimes \bra{-_\epsilon} \right) \left( P^{S_z}_\pm \ket{\psi_s} \otimes \ket{\pm_\mathcal{X}} \otimes \ket{\pm_\epsilon}\right) \\ \nonumber
   &= \bra{\psi_s} P^{S_z}_\pm \ket{\psi_s} \braket{\pm_\mathcal{X}|\pm_\mathcal{X}} \braket{\pm_\epsilon|\pm_\epsilon} \\ \nonumber
   &= \bra{\psi_s} P^{S_z}_\pm \ket{\psi_s}
\end{align}
We have reproduced the prediction of the standard Born Rule TODO ref.

\section{Consistency Conditions}

In standard quantum mechanics, the third postulate defines the subset of states corresponding to ``measurement results'', and the fourth postulate makes predictions about these states only. Now that we have extended the Born Rule to make predictions about histories, we need to be careful about the context in which the predictions are made.

\subsection{Experiment 1}

We saw that the extended Born Rule reproduces the probabilities of the standard Born Rule. However, the extension goes on to make predictions about other outcomes. For example, we could ask about the probability that spin-up in the $x$ direction is measured using the history
\begin{align}
  h_{+_x} &= (P_\varnothing ,P_{+_x} )
\end{align}
which results in
\begin{align}
  \mathcal{P}(h_{+_x}) &= \bra{\psi_h} C_{+_x} \ket{\psi_h}  \\ \nonumber
  &= \bra{\psi_s} P^{S_x}_+ \ket{\psi_s}
\end{align}
which is non-zero in general. We could ask an infinite amount of similar questions, since the spin Hilbert space includes states representing spin-up along every direction in space TODO REF STATE SPACE SECTION. Consequently, our probabilities no longer sum to unity, which is not consistent with probaility theory. The cause of this inconsistency is that $P_{+_z}$ and $P_{+_x}$ belong to incompatible sample spaces, so we are comparing predictions made within different contexts.

In TODO REF 5.1, we defined events as elements of some specific sample space. The extended Born Rule assigns probabilities to sequences of events \textit{within the context of their sample spaces}. The idea of consistency conditions is to explicitly state the context in which preidctions are made.

To establish such a context, we construct a sample space of histories by finding a set of histories that are mutually exclusive and exhaustive:
\begin{align}
  S = \{h \}: \\ \nonumber
  \sum_{h \in S} C_h &= I \\ \nonumber
  C_h^\dagger C_h' &= \delta_{h,h'} C_h \\
\end{align}

A set of histories $S$ satisfying these conditions a \textit{family} of histories. To find a family for this experiment, we start with the spin-up and spin-down histories:
\begin{align}
  S = \{ \left(P_\varnothing, P_{+_z} \right), \left(P_\varnothing, P_{-_x} \right)\}
\end{align}

Though the probabilities of these histories sum to one, the set is not yet complete:
\begin{align}
  \sum_{h \in S} C_h &= P_{\psi_s} P^{S_z}_+ \otimes P^\mathcal{X}_\varnothing \otimes P^\epsilon_\varnothing + P_{\psi_s} P^{S_z}_- \otimes P^\mathcal{X}_\varnothing \otimes P^\epsilon_\varnothing \\ \nonumber
  &= P_{\psi_s} \otimes P^\mathcal{X}_\varnothing \otimes P^\epsilon_\varnothing \neq I
\end{align}

Finding the class operator that completes the set,
\begin{align}
  C_{I-\varnothing} &= I - \left(P_{\psi_s} \otimes P^\mathcal{X}_\varnothing \otimes P^\epsilon_\varnothing \right)
\end{align}

This is the class operator for any system not starting in the initial spin state, not starting in the ready position, or not starting with a ready environment. In other words, $C_{I-\varnothing}$ represents histories that start in some state other than the initial state. Even though these histories never occur, they must be included to complete the family; the prediction of non-occurence of $I - \varnothing$ is part of the context.

Due to the position system's continuous sample space, there are an infinite number of histories distinct from the initial state with zero chance of occurence. Calling one such history $h_{I-\varnothing}^i$,
\begin{align}
  S = \{\{ P_\varnothing, P^{S_z}_+ \}, \{P_\varnothing, P^{S_z}_- \} \} \cup \{h_{I-\varnothing}^i\}
\end{align}

Now that we have an exhaustive set, we show that its histories are mutually exclusive:
\begin{align}
  C_+^\dagger C_- &= \left( P_{+_z}(t_1)  P_\varnothing(t_0) \right) \left(P_\varnothing(t_0) P_{-_z}(t_1) \right) \\ \nonumber
  &= P_{+_z}(t_1) P_{-_z}(t_1) \\ \nonumber
  &= U^\dagger(t_1, t_0) P_{+_z} U(t_1, t_0) U^\dagger(t_1, t_0) P_{-_z} U(t_1, t_0)  \\ \nonumber
  &= U^\dagger(t_1, t_0) P_{+_z}P_{-_z} U(t_1, t_0) \\ \nonumber
  &= U^\dagger(t_1, t_0) \left( P^{S_z}_+ P^{S_z}_-  \otimes P^\mathcal{X}_+ P^\mathcal{X}_- \otimes P^\epsilon_+ P^\epsilon_- \right) U(t_1, t_0) \\ \nonumber
  &= 0
\end{align}
and
\begin{align}
  C_\pm^\dagger C_{I-\varnothing} &= \left( P_{+_z}(t_1)  P_\varnothing(t_0) \right) \left( \left(I-P_\varnothing\right) \right) \\ \nonumber
  &= P_{+_z}(t_1)  \left(P_\varnothing - P_\varnothing \right)\\ \nonumber
  &= 0
\end{align}

The set $S$ is shown to be a consistent family of histories, so the predictions of REF are made within this context.
% \begin{align}
%   C_+ &= P_\varnothing U(t_1, t_0) P^z_+ U^\dagger(t_1, t_0) \\
%   &= \left(P_{\psi_s} \otimes P^\mathcal{X}_\varnothing \otimes P^\epsilon_\varnothing \right) U(t_1, t_0) \left(P^z_+ \otimes P^\mathcal{X}_+ \otimes P^\epsilon_+ \right) U^\dagger(t_1, t_0)
% \end{align}
%
% \begin{align}
%   U(t_1, t_0) P^z_+ &= \left( P^z_+ \otimes \left(\: \ket{+_\mathcal{X}}\bra{\varnothing_\mathcal{X}} \: \bm{+} \: \ket{\varnothing_\mathcal{X}}\bra{+_\mathcal{X}} \: \bm{+} \: \ket{-_\mathcal{X}}\bra{-_\mathcal{X}} \: \bm{+} \: I_\mathcal{X} \: \bm{-} \: P^\mathcal{X}_+  \: \bm{-} \: P^\mathcal{X}_\varnothing \: \right) \right) \left(P^z_+ \otimes P^\mathcal{X}_+ \otimes P^\epsilon_+ \right) \\
%   &= P^z_+ \otimes \ket{\varnothing_\mathcal{X}}\bra{+_\mathcal{X}} \otimes \ket{\varnothing_\epsilon}\bra{+_\epsilon}
% \end{align}
%
% \begin{align}
%   P_\varnothing U(t_1, t_0) P^z_+ &=  \left(P_{\psi_s} \otimes P^\mathcal{X}_\varnothing \otimes P^\epsilon_\varnothing \right) \left(P^z_+ \otimes \ket{\varnothing_\mathcal{X}}\bra{+_\mathcal{X}} \otimes \ket{\varnothing_\epsilon}\bra{+_\epsilon}\right) \\
%   &= P_{\psi_s}P^z_+ \otimes \ket{\varnothing_\mathcal{X}}\bra{+_\mathcal{X}} \otimes \ket{\varnothing_\epsilon}\bra{+_\epsilon}
% \end{align}
%
% \begin{align}
%     C_+ &= P_\varnothing U(t_1, t_0) P^z_+ U^\dagger(t_1, t_0) \\
%     &= \left(P_{\psi_s}P^z_+ \otimes \ket{\varnothing_\mathcal{X}}\bra{+_\mathcal{X}} \otimes \ket{\varnothing_\epsilon}\bra{+_\epsilon} \right) \left( P^z_+ \otimes \left(\: \ket{+_\mathcal{X}}\bra{\varnothing_\mathcal{X}} \: \bm{+} \: \ket{\varnothing_\mathcal{X}}\bra{+_\mathcal{X}} \: \bm{+} \: \ket{-_\mathcal{X}}\bra{-_\mathcal{X}} \: \bm{+} \: I_\mathcal{X} \: \bm{-} \: P^\mathcal{X}_+  \: \bm{-} \: P^\mathcal{X}_\varnothing \: \right) \right) \\
%     &= P_{\psi_s}P^z_+ \otimes P^\mathcal{X}_\varnothing \otimes P^\epslion_\varnothing
% \end{align}
% \begin{align}
%   C_+ + C_- &= P_{\psi_s} \otimes P^\mathcal{X}_\varnothing \otimes P^\epsilon_\varnothing
% \end{align}

\section{Experiment 2}

Using the same reasoning, we find a consistent family for the experiment shown in TODO REF FIG
\begin{align}
  \{ h_{+_z,+_x} = \left(P_\varnothing, P_{+_z}, P_{+_x} \right), h_{+_z,-_x} = \left(P_\varnothing, P_{+_z}, P_{-_x} \right), h_{-_z} = \left(P_\varnothing, P_{-_z} \right), h_{I-\varnothing} = \left(I - P_\varnothing \right)\}
\end{align}
Notice that histories do not need to specify the same amount of events to form a consistent family.

Using the extended Born Rule, we calculate the probability of measuring spin up in both analyzers
\begin{align}
  \mathcal{P}(+_z, +_x) &= \bra{\psi} C^\dagger_{+_z, +_x} \ket{\psi} \\ \nonumber
  &= \bra{\psi} P_{+_x}(t_2) P_{+_z}(t_1) P_{\psi_s} \ket{\psi} \\ \nonumber
  &= \bra{\psi} U^\dagger(t_2, t_0) P_{+_x} U(t_2, t_0) U^\dagger(t_1, t_0) P_{+_z} U(t_1, t_0)  \ket{\psi} \\ \nonumber
  &= \bra{\psi} U^\dagger(t_2, t_0) P_{+_x} U(t_2, t_1) P_{+_z} U(t_1, t_0) \ket{\psi}
\end{align}
Using dynamics found in TODO ref,
\begin{align}
  U(t_2, t_0) &= U(t_2, t_1)U(t_1, t_0) \\ \nonumber
  &= P^{S_x}_+ P^{S_z}_+ \otimes E^\mathcal{X}_{+^2, +^1} E^\mathcal{X}_{+^1, \varnothing^1} \otimes E^{\epsilon_1}_{+, \varnothing} \otimes E^{\epsilon_2}_{+, \varnothing} \\ \nonumber
  &\phantom{{} = {}} + P^{S_x}_- P^{S_z}_+ \otimes E^\mathcal{X}_{+^2, -^1} E^\mathcal{X}_{+^1, \varnothing^1} \otimes E^{\epsilon_1}_{+, \varnothing} \otimes E^{\epsilon_2}_{-, \varnothing}\\ \nonumber
  &\phantom{{} = {}}  + P^{S_z}_- \otimes I_\mathcal{X} \otimes I_{\epsilon_1} \otimes I_{\epsilon_2}
\end{align}
The event operators select the spin-up/spin-up branch
\begin{align}
   P_{+_x} U(t_2, t_1) P_{+_z} &= P^{S_x}_+ P^{S_z}_+ \otimes E^\mathcal{X}_{+^2, +^1} E^\mathcal{X}_{+^1, \varnothing^1} \otimes I_{\epsilon_1} \otimes E^{\epsilon_2}_{+, \varnothing}
\end{align}
so
\begin{align}
  \mathcal{P}(+_z, +_x) &= \bra{\psi} U^\dagger(t_2, t_0) P_{+_x} U(t_2, t_1) P_{+_z} U(t_1, t_0) \ket{\psi} \\ \nonumber
  &= \bra{\psi} U^\dagger(t_2, t_0) \left(P^{S_x}_+ P^{S_z}_+ \otimes E^\mathcal{X}_{+^2, +^1} E^\mathcal{X}_{+^1, \varnothing^1} \otimes I_{\epsilon_1} \otimes E^{\epsilon_2}_{+, \varnothing} \right) U(t_1, t_0) \ket{\psi} \\ \nonumber
  &= \bra{\psi}  U^\dagger(t_2, t_0) \left(P^{S_x}_+ P^{S_z}_+ \otimes E^\mathcal{X}_{+^2, +^1} E^\mathcal{X}_{+^1, \varnothing^1}  E^{\mathcal{X}}_{+^1, \varnothing^1} \otimes E^{\epsilon_1}_{+, \varnothing} \otimes E^{\epsilon_2}_{+, \varnothing} \right) \ket{\psi} \\ \nonumber
  &= \bra{\psi}  U^\dagger(t_2, t_0) \left(P^{S_x}_+ P^{S_z}_+ \otimes E^\mathcal{X}_{+^2, +^1} \otimes E^{\epsilon_1}_{+, \varnothing} \otimes E^{\epsilon_2}_{+, \varnothing} \right) \ket{\psi}  \\ \nonumber
  &= \bra{\psi} \left(P^{S_z}_+ P^{S_x}_+ P^{S_z}_+ \otimes E^\mathcal{X}_{+^2, \varnothing^2}E^\mathcal{X}_{+^2, \varnothing^2} \otimes E^{\epsilon_1}_{+, \varnothing} E^{\epsilon_1}_{+, \varnothing} \otimes E^{\epsilon_2}_{+, \varnothing} E^{\epsilon_2}_{+, \varnothing} \right) \ket{\psi} \\ \nonumber
  &= \bra{\psi} \left(P^{S_z}_+ P^{S_x}_+ P^{S_z}_+ \otimes I_\mathcal{X}  \otimes I_{\epsilon_1} \otimes I_{\epsilon_2} \right) \ket{\psi} \\ \nonumber
  &= \bra{\psi_s} P^{S_z}_+ P^{S_x}_+ P^{S_z}_+ \ket{\psi_s}
\end{align}
Similarly, the probabilities for all other possible outcomes are
\begin{align}
  \mathcal{P}(+_z, -_x) &= \bra{\psi_s} P^{S_z}_+ P^{S_x}_- P^{S_z}_+ \ket{\psi_s} \\ \nonumber
  \mathcal{P}(-_z) &= \bra{\psi_s} P^{S_z}_- \ket{\psi_s}
\end{align}
% \begin{align}
%    U(t_1, t_0)\ket{\psi} &= \left( P^{S_z}_+ \ket{\psi_s} \otimes \ket{+^1_\mathcal{X}} \otimes \ket{+_{\epsilon_1}} \otimes \ket{\varnothing_{\epsilon_2}} \right) + \left( P^{S_z}_- \ket{\psi_s} \otimes \ket{-^1_\mathcal{X}} \otimes \ket{-_{\epsilon_1}} \otimes \ket{\varnothing_{\epsilon_2}} \right)
% \end{align}
% and
% \begin{align}
%   \bra{\psi} U^\dagger(t_2, t_0) &= \left( U(t_2, t_1) U(t_1, t_0) \ket{\psi} \right)^\dagger
%   \\ \nonumber
%   &= \left( U(t_2, t_1) \left( P^{S_z}_+ \ket{\psi_s} \otimes \ket{+^1_\mathcal{X}} \otimes \ket{+_{\epsilon_1}} \otimes \ket{\varnothing_{\epsilon_2}} \right) \right. \\ \nonumber
%   &\phantom{{}={}} \left. + \left( P^{S_z}_- \ket{\psi_s} \otimes \ket{-^1_\mathcal{X}} \otimes \ket{-_{\epsilon_1}} \otimes \ket{\varnothing_{\epsilon_2}} \right) \right)^\dagger \\ \nonumber
%   &= \left( P^{S_x}_+ P^{S_z}_+ \ket{\psi_s} \otimes \ket{+^2_\mathcal{X}} \otimes \ket{+_{\epsilon_1}} \otimes \ket{+_{\epsilon_2}} \right. \\ \nonumber
%   &\phantom{{}={}} \left. + P^{S_x}_- P^{S_z}_+ \ket{\psi_s} \otimes \ket{-^2_\mathcal{X}} \otimes \ket{+_{\epsilon_1}} \otimes \ket{-_{\epsilon_2}} \right. \\ \nonumber
%   &\phantom{{}={}} +  \left.  P^{S_z}_- \ket{\psi_s} \otimes \ket{-^1_\mathcal{X}} \otimes \ket{-_{\epsilon_1}} \otimes \ket{\varnothing_{\epsilon_2}}  \right)^\dagger
% \end{align}
% then
% \begin{align}
%   P_{+_x} U(t_2, t_1) P_{+_z} U(t_1, t_0) \ket{\psi} &= P_{+_x} U(t_2, t_1) \left( P^{S_z}_+ \ket{\psi_s} \otimes \ket{+^1_\mathcal{X}} \otimes \ket{+_{\epsilon_1}} \otimes \ket{\varnothing_{\epsilon_2}} \right)
% \end{align}

\section{Coarse Grained Histories}
In TODO REF, we ignored electrons measured spin-down in the $z$ analyzer. The purpose of this was to effectively prepare an initial spin state $\ket{+}$ for the $S_x$ measurement. This was possible because probabilities are calculated one measurement at a time, with probability theory combining the results.

In the consistent histories approach, it is crucial to exhaust all possible outcomes to construct a context for predictions. We cannot simply ignore the spin-down electrons, as we no longer renormalize states upon each measurement.

\section{Decoherence}
TODO: exemplify how tracing out degrees of freedom results in mixed state, discuss what happens if environment is not a perfect record keeper.



 It is important to note that the vast majority of which state information is unaccessible for all practical purposes;

 If one understood the nature of all systems interacting with the electron, how well would they be able to answer questions about the history of the electron? The existence of which path
%
% All remaining content are outlines/notes.
%
% TODO: introduce decoherence, explain role played by vnms. Incomplete which path, Environment continuously monitors system. TODO: sometimes we must ignore the environment, results are inaccessible or ignored experimentally.
%
% \section{Density Matrices}
% As stated in TODO ref, $\ket{\psi}$ can no longer be written in the form $\ket{\psi}_s \otimes \ket{\mathcal{X}}_z$. Rather, $\ket{\psi}$ is a superposition of such states; quantum \textit{coherency} has been extended from the spin system to the spin-pointer composite system.
%
% In the case of environmental decoherence, we assume that this type of interaction while possessing no information about the pointer system. Since multiple pointer states may correspond to the same spin state, ``ignoring the environment'' now means that we must coarse grain out all possible environment states for each spin state. We can no longer ``factor out'' the environment subsystem.
%
% Some definite environment state is realized; we just do not know which one. This uncertainty is classical in nature; it has nothing to do with any inherent quantum uncertainty. We are now dealing with a "classical mixture" of superposition states.
%
% Such a system is well represented by a \textit{density matrix}. For a \textit{pure state}, the representative density matrix is just the projection operator for that state
% \begin{align}
%   \rho = \ket{\psi}\bra{\psi}
% \end{align}
%
% Recall that when considering the projection operator of some state, we can equivalently think of the subset of states in the Hilbert space into which it projects.
%
% The density operator for the state after measurement is
% \begin{align}
% \rho &= \sum_{n,m}\left({P^z}_n\ket{\psi}_s \otimes \ket{\mathcal{X}_n}_z \right) \cdot \left({P^z}_m\bra{\psi} \otimes \bra{\mathcal{X}_m} \right) \\
% \rho &=  \sum_{n,m}\braket{n|\psi}_s \braket{m|\psi}_s \ket{n}\bra{m} \otimes \ket{\mathcal{X}_n}_z \bra{\mathcal{X}_m}
% \end{align}
%
% \section{Density matrix Born rule}
% The Born Rule can also be expressed in terms of \textit{density matrices}. From (TODO: reference appendix), we know that an inner product can be written as the trace of the corresponding dyad. The Born Rule is the complex square of an inner product, so we should be able to assign probabilities to detection states by tracing over some corresponding tensor. We will manipulate the Born Rule to take this form, and then examine the resulting tensor.
%
% Expanding the complex square,
% \begin{align}
%   \mathcal{P}(n) &= \left(\bra{D_n}V\ket{\psi}\right) \cdot \left(\bra{D_n}V\ket{\psi}\right)^* \\
%   \mathcal{P}(n) &= \left(\bra{D_n}V\ket{\psi}\right) \cdot \left(\bra{\psi}V^\dagger\ket{D_n}\right)
% \end{align}
% Rewriting the second inner product as the trace of a dyad,
% \begin{align}
%   \mathcal{P}(n) &= \left(\bra{D_n}V\ket{\psi}\right) \cdot Tr\left(\ket{D_n}\bra{\psi}V^\dagger\right)f
% \end{align}
% The remaining inner product, like any, is a scalar. Since trace is a linear operator, we can scale any factor inside the operation by this inner product.
% \begin{align}
%   \mathcal{P}(n) &= Tr\left(\ket{D_n} \cdot \left(\bra{D_n}V\ket{\psi}\right) \cdot \left(\bra{\psi}V^\dagger\right)\right)
% \end{align}
% Now we can rewrite $\ket{D_n}\bra{D_n}$ as ${P^D}_n$, and simplify grouping:
% \begin{align}
%   \mathcal{P}(n) &= Tr\left({P^D}_n \cdot \left(V\ket{\psi}\bra{\psi}V^\dagger\right)\right)
% \end{align}
%
% TODO: discuss remaining object ${P^D}_n \cdot \left(V\ket{\psi}\bra{\psi}V^\dagger\right)$
% TODO: discuss coarse graining, conditional probabilities
%
% \chapter{Complementarity}
% We now discuss the the principle of complementarity in the context of standard and consistent quantum mechanics. Arguably the most fundamental feature of quantum mechanics, the principle of complementarity states that a quantum system has pairs of physical observables which cannot be measured simultaneously. The operators corresponding to pairs of complementary properties do not commute; that is, $[A,B] = AB - BA \neq 0$. Components of spin on orthogonal axes are complementary properties, so we examine measurements of succesive Stern-Gerlach experiments.
%
% \chapter{Simulation}
% Research for this section is complete. I expect writing this section to take 1-2 days of writing, to be done over spring break.
%
% \section{Standard Description}
% Using the Born Rule, we calculate the probabilities of observing each final state in Figure 4.1. The first apparatus serves as a state preparation device with output $\ket{+}$. By the direction of the projection postulate, the state is renormalized upon each measurement. After measuring a property complementary to what is known (such as spin along $x$, knowing spin along $z$), any information known about the input state is lost; the input state instantaneously changes to the state corresponding to the observed quantity. Consequently, there is an equal probability of observing the final state as $\ket{+}$ or $\ket{-}$ at either final apparatus, even though the state was initially prepared as $\ket{+}$, since
% \begin{align}
%     \mathcal{P}_n &= |\braket{+|+}_y|^2 \\
%                   &= |\braket{-|+}_y|^2 \\
%                   &= |\braket{+|-}_y|^2 \\
%                   &= |\braket{-|-}_y|^2 \\
%                   &= \frac{1}{4}
% \end{align}
% TODO: make above separate equations for clarity.
% It appears that this contradiction with classical intuition is a direct result of the projection postulate. The act of measurement and ensuing state collapse causes the system to shed properties previously recorded.
%
% \section{Consistent Description}
% TODO: calculate probabilities using consistent Born Rule.
% Consistent quantum theory predicts the same loss of a definite $S_z$ value, but for different reasons.
% The description of measurment in consistent histories does not postulate state collapse; rather, the system evolves through some Hamiltonian that correlates system and detector states. This implies that the measurement process has nothing to do with the principle of complementarity. We can trace the cause back to our definition of the state space. For a spin state, $\ket{\psi}$ is completely defined by spin-up or spin-down in a single direction $w$. The Hilbert space does not include states that could be interpreted as possesing a definite spin value in more than one direction. Consequently, the operators for spin in directions not parallel or antiparallel to each other share no eigenstates. It follows mathematically that these operators do not commute: TODO run through this math.
%
% This description of complementary implies that the principle is a limitation inherent to the quantum state, rather than a consequence of the role of measurement. In consistent histories, this limitation is embodied by \textit{the single framework rule}. There exists multiple ways in which a quantum system can be described, yet descriptions from only one of these \textit{frameworks} can be meaningfully compared or combined.
%
% \begin{figure}
% \centering\CaptionFontSize
% \begin{tikzpicture}[shorten >=1pt,auto, thick,
%      square node/.style={rectangle, minimum height=2cm, minimum width=1.50cm, text width = 1.25cm, draw, font=\sffamily\Large\bfseries},
%      port/.style={rectangle, draw,  minimum height=1cm, minimum width=0.75cm, font=\sffamily\Large\bfseries},
%      wf/.style={rectangle, minimum height=1cm}]
%     \apparatus{1}{2}{0}{$Z$};
%     \apparatus{2}{5}{1.25}{$Y$};
%     \apparatus{3}{10}{2.50}{$Z$};
%     \apparatus{4}{10}{0}{$Z$};
%
%     \node[wf] (w0) at (0,0) {$\ket{\psi}$};
%     \node[wf] (w1) at (15, 3.0) {${P^z}_+{P^y}_+{P^z}_+\ket{\psi} \otimes \ket{D_z}_+ \otimes \ket{D_y}_+ \otimes \ket{D_z}_+$};
%     \node[wf] (w2) at (15, 2.0) {${P^z}_-{P^y}_+{P^z}_+\ket{\psi} \otimes \ket{D_z}_+ \otimes \ket{D_y}_+ \otimes \ket{D_z}_-$};
%     \node[wf] (w3) at (15, 0.5) {${P^z}_+{P^y}_-{P^z}_+\ket{\psi} \otimes \ket{D_z}_+ \otimes \ket{D_y}_- \otimes \ket{D_z}_+$};
%     \node[wf] (w4) at (15, -0.5) {${P^z}_-{P^y}_-{P^z}_+\ket{\psi} \otimes \ket{D_z}_+ \otimes \ket{D_y}_- \otimes \ket{D_z}_-$};
%
%     \draw[line width=0.5mm] (w0) -- (1);
%
%     \draw[line width=0.5mm] (1+) -- (2) node [near end] {${P^z}_+\ket{\psi} \otimes \ket{D_z}_+ $};
%
%     \draw[line width=0.5mm] (2-) -- (4) node [near start, below, yshift=-0.35cm] {${P^y}_-{P^z}_+\ket{\psi} \otimes \ket{D_z}_+ \otimes \ket{D_y}_-$};
%     \draw[line width=0.5mm] (2+) -- (3) node [near start, above, yshift=0.35cm] {${P^y}_+{P^z}_+\ket{\psi} \otimes \ket{D_z}_+ \otimes \ket{D_y}_+$};
%
%     \draw[line width=0.5mm] (3-) -- (w2);
%     \draw[line width=0.5mm] (3+) -- (w1);
%     \draw[line width=0.5mm] (4-) -- (w4);
%     \draw[line width=0.5mm] (4+) -- (w3);
% \end{tikzpicture}
% \caption[Insert an abbreviated caption here to show in the List of Figures]
% {Demonstrating complementary measurments in consistent quantum mechanics}
% \label{Figure:Intro:FigureExampleD}
% \end{figure}
%
% \begin{figure}
% \centering\CaptionFontSize
% \begin{tikzpicture}[shorten >=1pt,auto, thick,
%      square node/.style={rectangle, minimum height=2cm, minimum width=1.50cm, text width = 1cm, draw, font=\sffamily\Large\bfseries},
%      port/.style={rectangle, draw,  minimum height=1cm, minimum width=0.75cm, font=\sffamily\Large\bfseries},
%      wf/.style={rectangle, minimum height=1cm}]
%     \apparatus{1}{3}{0}{Z};
%     \apparatus{2}{6}{1}{X};
%     \apparatus{3}{9}{1}{Z};
%
%     \node[wf] (w0) at (0,0) {$\ket{\psi}$};
%     \node[wf] (w1) at (12,2.5) {$\ket{\psi_1}$};
%     \node[wf] (w2) at (12,1.5) {$\ket{\psi_2}$};
%     \node[wf] (w3) at (12,0.5) {$\ket{\psi_3}$};
%     \node[wf] (w4) at (12,-0.5) {$\ket{\psi_4}$};
%
%     \draw[line width=0.5mm] (w0) -- (1);
%
%     \draw[transform canvas={yshift=-0.6em}, line width=0.5mm, loosely dotted] (1+) -- (2);
%     \draw[transform canvas={yshift=-0.2em}, line width=0.5mm, dotted] (1+) -- (2);
%     \draw[transform canvas={yshift=0.2em}, line width=0.5mm, dashed] (1+) -- (2);
%     \draw[transform canvas={yshift=0.6em}, line width=0.5mm] (1+) -- (2);
%
%     \draw[transform canvas={yshift=-0.4em}, line width=0.5mm, loosely dotted] (2-) -- (3);
%     \draw[transform canvas={yshift=0em}, line width=0.5mm, dotted] (2-) -- (3);
%     \draw[transform canvas={yshift=0em}, line width=0.5mm, dashed] (2+) -- (3);
%     \draw[transform canvas={yshift=0.4em}, line width=0.5mm] (2+) -- (3);
%
%     \draw[line width=0.5mm, loosely dotted] (3-) -- (w4);
%     \draw[line width=0.5mm, dashed] (3-) -- (w3);
%     \draw[line width=0.5mm, dotted] (3+) -- (w2);
%     \draw[line width=0.5mm] (3+) -- (w1);
% \end{tikzpicture}
% \caption[Insert an abbreviated caption here to show in the List of Figures]
% {TODO: create section to discuss this example}
% \label{Figure:Intro:FigureExampleE}
% \end{figure}

% \chapter{Unitary Evolution in a Magnetic Field}
% TODO: examples, discussion of similar experiments in an external B-field
% TODO: describe unitary, collapse frameworks as described in colloqium paper
